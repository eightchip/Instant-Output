# 管理者モード拡張提案 v2

## 現在の実装状況

### ✅ 実装済み
1. **Whisper API音声認識** - 英語音声入力時に高精度認識（管理者専用）
2. **セッション管理** - 24時間有効、自動延長機能
3. **管理者ログイン/メニュー** - ホーム画面に表示

### 🔄 検討中
- **再翻訳にWhisper APIを使用** - ユーザー要望

---

## 提案機能一覧

### 1. 再翻訳にWhisper APIを使用 ⭐（ユーザー要望）

**概要**: カード編集画面やスクリーンショット追加画面の「再翻訳」ボタンで、Whisper APIを使用して音声から直接翻訳

**使用場面**:
- カード編集画面で英語文を音声で読み上げて再翻訳
- スクリーンショット追加画面でOCR結果を音声で確認・修正

**実装方法**:
- 再翻訳ボタンの横に「🎤 音声で再翻訳」ボタンを追加
- 音声録音 → Whisper APIで認識 → ChatGPT APIで翻訳
- 管理者がログインしている場合のみ表示

**トークン消費**: 
- Whisper API: 約$0.006/分
- ChatGPT翻訳: 約100-200トークン/文

**優先度**: ⭐⭐⭐⭐⭐（ユーザー要望）

---

### 2. 英語文章の自動校正・改善

**概要**: 英語文を自然な表現に改善（学習用に最適化）

**使用場面**:
- カード編集画面で「✨ 文章を改善」ボタン
- スクリーンショット追加画面でOCR結果を改善

**機能**:
- 文法チェック
- 自然な表現への改善
- 学習用に適した難易度調整

**プロンプト例**: 
```
Improve this English sentence for language learning, making it more natural while keeping the same meaning. If the sentence is already good, return it as is.
```

**トークン消費**: 約200-300トークン/文

**優先度**: ⭐⭐⭐⭐

---

### 3. 語彙の自動抽出と意味の自動取得

**概要**: カードから重要単語を抽出し、意味を自動取得して語彙リストに追加

**使用場面**:
- カード保存時、管理者が「📚 語彙を自動抽出」ボタンを押す
- 一括で複数カードから語彙を抽出

**機能**:
- 重要単語の自動抽出（既存の`getImportantWords`を拡張）
- 各単語の意味をChatGPT APIで取得
- 語彙リストに自動追加（ユーザー確認後）

**トークン消費**: 約150-250トークン/カード

**優先度**: ⭐⭐⭐⭐

---

### 4. 一括カード操作（AI機能付き）

**概要**: 複数のカードを一括で処理

**機能**:
- 一括翻訳（複数カードの英語を一括で日本語に翻訳）
- 一括校正（複数カードの英語を一括で改善）
- 一括語彙抽出（複数カードから語彙を一括抽出）

**使用場面**:
- カード検索画面で複数カードを選択して一括処理
- レッスン管理画面でレッスン内の全カードを一括処理

**トークン消費**: カード数 × 各機能のトークン

**優先度**: ⭐⭐⭐

---

### 5. タグの自動生成

**概要**: カードの内容から自動でタグを生成

**機能**:
- トピック（例: "business", "travel", "academic"）
- 難易度（例: "beginner", "intermediate", "advanced"）
- 文法項目（例: "past-tense", "conditional", "passive-voice"）

**使用場面**:
- カード保存時に自動でタグを提案
- 既存カードに一括でタグを追加

**トークン消費**: 約50-100トークン/カード

**優先度**: ⭐⭐⭐

---

### 6. 学習進捗分析（低トークン）

**概要**: 学習データを分析してレポートを生成

**機能**:
- よく間違える単語の分析
- 学習ペースの可視化
- 復習スケジュールの最適化提案

**使用場面**:
- 管理者メニューから「📊 学習分析」を選択
- 週次/月次のレポート生成

**トークン消費**: ほぼゼロ（既存データの分析のみ）

**優先度**: ⭐⭐

---

### 7. カードの自動品質チェック

**概要**: カードの品質を自動でチェックして改善提案

**機能**:
- 英語文の長さチェック（長すぎる/短すぎる）
- 日本語訳の適切性チェック
- 重要単語の抽出漏れチェック

**使用場面**:
- カード保存時に自動チェック
- 一括で全カードをチェック

**トークン消費**: 約100-150トークン/カード

**優先度**: ⭐⭐

---

## 実装優先順位

### Phase 1（即座に実装）
1. ✅ **再翻訳にWhisper APIを使用** - ユーザー要望

### Phase 2（高優先度）
2. **英語文章の自動校正・改善** - よく使う機能
3. **語彙の自動抽出と意味の自動取得** - 効率化に直結

### Phase 3（中優先度）
4. **一括カード操作（AI機能付き）** - 大量処理に便利
5. **タグの自動生成** - 整理に役立つ

### Phase 4（低優先度）
6. **学習進捗分析** - 分析機能
7. **カードの自動品質チェック** - 品質向上

---

## トークン消費の目安

| 機能 | 1回あたりのトークン | 1回あたりのコスト（概算） |
|------|---------------------|--------------------------|
| Whisper API（1分） | - | $0.006 |
| 再翻訳（Whisper + ChatGPT） | 100-200 | $0.002-0.004 |
| 文章改善 | 200-300 | $0.004-0.006 |
| 語彙抽出 | 150-250 | $0.003-0.005 |
| 一括翻訳（10カード） | 1000-2000 | $0.02-0.04 |
| タグ生成 | 50-100 | $0.001-0.002 |

**注意**: トークン消費は実際の使用量によって変動します。

---

## 実装時の注意点

1. **セッション認証**: すべての管理者機能でセッション認証を必須にする
2. **エラーハンドリング**: API呼び出し失敗時の適切なエラーメッセージ
3. **ローディング表示**: 処理中は明確なローディング表示
4. **トークン消費の可視化**: 管理者がトークン消費を確認できるように（オプション）
